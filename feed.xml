<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" xml:lang="br"><generator uri="https://jekyllrb.com/" version="4.3.3">Jekyll</generator><link href="https://zezedp.github.io/feed.xml" rel="self" type="application/atom+xml"/><link href="https://zezedp.github.io/" rel="alternate" type="text/html" hreflang="br"/><updated>2024-02-04T19:33:05+00:00</updated><id>https://zezedp.github.io/feed.xml</id><title type="html">blank</title><subtitle>A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design. </subtitle><entry><title type="html">Criptografia de Curvas Elípticas: MenezesQuVanstone, ECDSA e Ataques</title><link href="https://zezedp.github.io/blog/2024/ecc/" rel="alternate" type="text/html" title="Criptografia de Curvas Elípticas: MenezesQuVanstone, ECDSA e Ataques"/><published>2024-02-03T00:20:00+00:00</published><updated>2024-02-03T00:20:00+00:00</updated><id>https://zezedp.github.io/blog/2024/ecc</id><content type="html" xml:base="https://zezedp.github.io/blog/2024/ecc/"><![CDATA[<h2 id="1-teoria-dos-grupos">1. Teoria dos Grupos</h2> <p>Para introduzir esse conceito, surigo uma alusão:</p> <p>Suponha que exista um grupo de 5 amigos que são próximos e outro grupo de 5 colegas de trabalho que não interagem muito, respectivamente \(G_1, G_2\). Entre eles, podem interagir de formas distintas como um aperto de mãos ou abraço.</p> <p>Não é um salto muito grande afirmar que os amigos do grupo \(G_1\) se abraçam, já que são próximos, mas para os colegas de trabalho do grupo \(G_2\) talvez não seja tão apropriado, sendo mais provável se apresentarem com um aperto de mãos.</p> <p>Para os dois grupos distintos, são estabelecidas formas de comunicação diferentes, seja o aperto de mão ou o abraço, e na Matemática não é tão diferente.</p> <h2 id="11-definição">1.1. Definição:</h2> <p>Um grupo pode ser descrito como um conjunto de \(n\) elementos e um operador de grupo, como adição ou multiplicação.</p> <p>Se um grupo \(G\) tem dois elementos \(a\) e \(b\) e seu operador for multiplicação, \(c=a \times b\).</p> <p>Para tal ser chamado de grupo, ele deve necessariamente respeitar os axiomas abaixo:</p> <ul> <li>Fechado: \(a\ 0 \ b =c \in G\)</li> <li>Associatividade: \((a \ 0 \ b) \ 0 \ c = a \ 0 \ (b \ 0 \ c) \in G\)</li> <li>Elemento Neutro: \(a \ 0 \ 1 = a\), onde 1 é o elemento neutro nesse caso</li> <li>Elemento Inverso: \(a \ 0 \ a^{-1}=1\)</li> </ul> <p>Contudo, para a criptografia de curva elítpicas vamos usar um grupo específico que será essencial para o Diffie-Hellman, o Grupo Abeliano, que tem uma mais propriedade:</p> <ul> <li>Comutatividade: \(a \ 0 \ b = b \ 0 \ a \in G\)</li> </ul> <h2 id="12-grupo-finito">1.2. Grupo Finito</h2> <p>Um grupo é finito se tem um número finito de elementos, onde sua cardinalidade é denotada por \(\# G\). Por exemplo, \(ℤ_9=\{0,1,2,3,4,5,6,7,8\}\), então sua cardinalidade é 9.</p> <h2 id="13-ordem-de-um-elemento">1.3. Ordem de um Elemento:</h2> <p>A ordem de um elemento \(a\) de um grupo \((G, 0)\) é o menor inteiro \(k\) que satisfaça:</p> \[a^k= \underbrace{a \ 0 \ a \dots a \ 0 \ a }_\text{k vezes}=1\] <p>onde 1 é o elemento neutro desse grupo \(G\).</p> <p>Vamos determinar a ordem de \(3\) em \(ℤ_5^*\):</p> \[3^1 \equiv 3 \mod5\] \[3^2 \equiv4 \mod5\] \[3^3 \equiv 2 \mod5\] \[3^4 \equiv 1 \mod5\] <p>Portanto, a ordem de 3 no grupo é: \(ord(3)=4\), que é justamente \(\# ℤ_5^*\)</p> <p>Não foram necessárias muitas operações para alcançar o elemento neutro do grupo, mas se continuarmos vamos observar um comportamento bem interessante:</p> \[3^5 \equiv 3 \mod5\] \[3^6 \equiv4 \mod5\] \[3^7 \equiv 2 \mod5\] \[3^8 \equiv 1 \mod5\] <p>A sequência de \(\{3,4,2,1\}\) vai se repetir para sempre, contudo isso não é o suficiente para afirmar que esse é um grupo cíclico, ao menos sem saber do Teorema 1.</p> <h3 id="teorema-1">Teorema 1:</h3> <p>Para um \(p\) primo, todo grupo \((ℤ_p^*, 0)\) é <strong><em>finito</em></strong>, <strong><em>abeliano</em></strong> e <strong><em>cíclico.</em></strong></p> <p>Segue o código em Python que encontra os geradores de um grupo \(ℤ^*_n, n&gt;2\):</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">encontra_gerador</span><span class="p">(</span><span class="n">n</span><span class="p">):</span> <span class="c1"># Recebe módulo n
</span>  <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="n">cont</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
      <span class="nf">if </span><span class="p">((</span><span class="n">x</span> <span class="o">**</span> <span class="n">i</span><span class="p">)</span> <span class="o">%</span> <span class="n">n</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">cont</span> <span class="o">==</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s"> é gerador do grupo ℤ*_</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
        <span class="k">break</span>
      <span class="n">cont</span> <span class="o">+=</span> <span class="mi">1</span>
</code></pre></div></div> <h2 id="14-grupo-cíclico">1.4. Grupo Cíclico:</h2> <p>Um grupo \(G\) é cíclico se o elemento de ordem máxima é a própria cardinalidade do grupo \(\#G\). Esses elementos são os <strong><em>geradores</em></strong> do grupo.</p> <p>No exemplo anterior foi encontrado um gerador sem saber o que era um. Perceba:</p> <p>\(ℤ_5^*=\{1,2,3,4\},\) e portanto \(\#ℤ_5^*=4\), que é a ordem do elemento 3 no grupo.</p> <p>Segue que, o grupo \(ℤ_5^*\) é cíclico e \(3\) é um dos elementos geradores desse grupo.</p> <p>Pode-se ir além e afirmar que todos os elementos desse grupo são geradores, pelo <strong>Teorema 2</strong>.</p> <h3 id="141-propriedades-dos-grupos-cíclicos">1.4.1. Propriedades dos Grupos Cíclicos:</h3> <p>Seja o grupo cíclico \(G\) de cardinalidade \(\# G\), então \(\forall a \in G\) vale que:</p> \[a^{\#G} \equiv 1\mod(\#G+1)\] \[ord(a) \mid \#G\] <p>A primeira propriedade vem do Pequeno Teorema de Fermat para \(ℤ_p^*:\)</p> <p>O grupo \(ℤ_p^*=\{1, 2, ..., (p-1)\}\) tem cardinalidade \((p-1)\), e portanto:</p> \[a^{(p-1)}\equiv1 \mod p\] <p>Já a segunda propriedade diz que a cardinalidade do grupo é divisível pelas ordens dos elementos dele. Logo, em \(ℤ_{11}^*=\{1,2,3,4,5,6,7,8,9,10\}\) as ordens dos elementos são:</p> \[ord(a)=\{1,2,5,10\}\] <h2 id="2-problema-do-logaritmo-discreto">2. Problema do Logaritmo Discreto:</h2> <p>Grupos cíclicos são importantes para problemas de logaritmo discreto, pois a partir de um gerador \(\alpha\) no grupo \(ℤ_p^*\) é possível encontrar todos os elementos desse Grupo.</p> <p>Exemplo:</p> <p>Em \(ℤ_{47}^*\) todos os elementos são geradores como foi falado no Teorema 1 , então se pegarmos um \(\alpha=5\), é possível encontrar todos os elementos do Grupo a partir de \(\alpha\).</p> <p>Dito isso, encontre \(x\):</p> \[5^x\equiv\ 41 \mod47,\] <p>Talvez você já tenha percebido que essa conta manualmente é extremamente complicada, pois exige o cálculo de</p> \[x\equiv \log_5 41 \mod 47\] <p>Contudo, como esse é um problema que envolve números pequenos, com um simples brute-force é encontrado o valor de \(x\).</p> <p>Vale ressaltar que, \(x\) respeita a desigualdade \(1 \leq x \leq 46\) pelo Pequeno Teorema de Fermat, pois</p> \[a^{(p-1)}\equiv1 \mod p\] <p>Assim, ele reinicia a sequência do Grupo Cíclico no elemento neutro \(1\).</p> <p>Segue abaixo o código em Python que realiza esse brute-force ingênuo:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">DLP_bruteforce_dumb</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">):</span>
	<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">mod</span><span class="p">):</span>
		<span class="nf">if </span><span class="p">(</span><span class="n">alpha</span><span class="o">**</span><span class="n">x</span> <span class="o">%</span> <span class="n">p</span> <span class="o">==</span> <span class="n">beta</span><span class="p">):</span>
			<span class="k">return</span> <span class="n">x</span>
</code></pre></div></div> <p>Se você rodar esse código com os parâmetros \(\alpha=5, \ \beta =41\) e \(p=47\) é retornado \(x=15\) em pouco tempo, porque esse problema está lidando com números bem pequenos e eles não seriam usados de forma alguma em um sistema de criptografia.</p> <p>Portanto, o problema do logaritmo discreto pode ser sintetizado em</p> <p>Dados \(p, \beta \in ℤ_{p}^*\) e o gerador \(\alpha\), encontre \(x\) que satisfaça a condição abaixo:</p> \[\alpha^x\equiv\beta \mod p\] <p>que é resolvido por</p> \[x \equiv \log_\alpha \beta \mod p\] <h2 id="3-curvas-elípticas">3. Curvas Elípticas</h2> <p>Por definição, uma curva elíptica em \(ℤ_p,\ p&gt;3\) é o conjunto de todos os pares coordenados \((x,y) \in ℤ_p\) que satisfazem</p> \[y^2\equiv x^3+ax+b \mod p\] <p>onde \(a,b \in ℤ_p\). Além de um ponto imaginário no infinito denotado por \(O\), e o discriminante \(4a^3+27b^2\ne0\), para que sejam curvas regulares.</p> <p>Quando essa curva é regular e se pode definir uma operação para o conjunto de pontos nela pertencentes, ela se torna um Grupo Abeliano.</p> <p>Caso ainda exista dúvida, verificamos se um ponto \(P\) pertence à curva se for verdade \(y^2-x^3-ax-b\equiv0 \mod p\).</p> <p>Toda curva elíptica que atenda a essas condições é simétrica em relação ao eixo \(x\) e isso é fácil de verificar:</p> <p>Seja a curva elíptica \(E:y^2=x^3-x+1\) no plano cartesiano, ao “tirar a raiz” de ambos os lados da equação obtemos</p> \[y=\pm\sqrt{x^3-x+1}\] <h2 id="4-grupos-em-curvas-elípticas">4. Grupos em Curvas Elípticas:</h2> <p>Para definir um grupo, é preciso um conjunto finito de elementos e um operador de grupo, são eles:</p> <ul> <li>O conjunto de pontos \((x,y) \in E:y^2\equiv x^3 + ax + b \mod p\)</li> <li>Operador de Adição \((+)\).</li> </ul> <p>A curva elíptica \(E\) é um Grupo Aditivo, e isso significa que vamos obter pontos a partir da soma binária deles.</p> \[P+Q =R\] <p>onde \(P=(x_1, y_1), Q=(x_2,y_2) \ e \ R=(x_3,y_3)\).</p> <p>Para isso acontecer, devemos garantir que o axioma 1 (Fechado) dos Grupos seja respeitado, <em>mas como?</em></p> <h3 id="41-adição-de-pontos-p-neq-q">4.1. Adição de Pontos \((P \neq Q)\):</h3> <p>Nesse cenário, o ponto \(R\) é obtido ao traçar uma reta entre os pontos \(P \ e \ Q\), que intersecta a curva em outro ponto, digamos \(R'\). Por fim, esse ponto é espelhado em relação ao eixo \(x\) da seguinte maneira</p> \[R'=(x_{R'}, y_{R'}) \rightarrow R=(x_{R'}, -y_{R'})\] <p>que é por definição \(R=-R'\).</p> <p>Exemplo:</p> <p>Sejam a curva elíptica \(E:y^2= x^3+ax+b\) e os pontos \(P=(x_P,y_P),Q=(x_Q,y_Q) \in E\).</p> <p>A reta \(r\) que passa por \(P \ e \ Q\) tem equação \(y=sx+m\), onde \(s\) é o coeficiente angular dessa reta.</p> <p>Lembrando que o coeficiente angular de uma reta em \(ℝ\) é dado por:</p> \[s=\frac{y_Q-y_P}{x_Q-x_P}\] <p>Mas vale ressaltar que, em \(ℤ_p\) é usado o Algoritmo de Euclides Estendido para encontrar o inverso multiplicativo:</p> \[s\equiv(y_Q-y_R)(x_Q-x_P)^{-1} \mod p\] <p>Substituindo \(y\) na curva \(E\) é obtido:</p> \[(sx+m)^2=x^3+ax+b\] \[s^2x^2+2smx+m^2=x^3+ax+b\] \[x^3-s^2x^2-2smx-m^2+ax+b=0\] \[x^3-s^2x^2+(a-2sm)x+(b-m^2)=0 \ \ \ \ \ \ (1)\] <p>Para encontrar \(R\) é preciso lembrar da característica de uma equação cúbica:</p> \[x^3+ax^2+bx+c=0, \ a\neq 0\] <p>Uma equação cúbica tem três raízes, que nesse caso são as coordenadas parciais \(x_P, x_Q, x_R\). Podemos usar isso na equação característica:</p> \[x^3+ax^2+bx+c= (x-x_P)(x-x_Q)(x-x_R)\] <p>Expandindo o lado direito da equação:</p> \[(x-x_P)(x-x_Q)(x-x_R)=\] \[=(x^2−(x_P+x_Q)x+x_Px_Q)(x−x_R)=\] \[=x^3−(x_P+x_Q+x_R)x^2+(x_Px_Q+x_Px_R+x_Qx_R)x−x_Px_Qx_R \ \ \ \ \ \ (2)\] <p>Podemos igualar os coeficientes das equações <strong>(1)</strong> e <strong>(2)</strong> e encontramos o valor desejado de \(x_R\).</p> \[\begin{cases} -s^2x^2= -(x_P+x_Q+x_R)x^2\\ (a-2sm)x = (x_Px_Q+x_Px_R+x_Qx_R)x \\ (b-m^2) = -x_Px_Qx_R\\ \end{cases}\] <p>Então:</p> \[-s^2=-(x_P+x_Q+x_R)\] \[s^2=(x_P+x_Q+x_R)\] <p>Isolando \(x_R\)</p> \[x_R=s^2-x_P-x_Q\] <p>Como agora temos \(x_R\), é possível determinar o valor de \(y_R\) partindo da equação da reta entre \(P \ e \ R\).</p> \[s=\frac{y_R-y_P}{x_R-x_P}\] <p>Com uma simples manipulação algébrica é encontrado \(y_R\):</p> \[s(x_R-x_P)=y_R-y_P\] \[y_R=s(x_R-x_P)+y_P\] <p>Mas ainda falta espelhar esse resultado em relação ao eixo x, ou seja, encontrar \(-y_R\):</p> \[-y_R=-s(x_R-x_P)-y_P\] <p>Que é equivalente a</p> \[-y_R=s(x_P-x_R)-y_P\] <h3 id="42-point-doubling-p--q">4.2. Point Doubling \((P = Q)\):</h3> <p>Quando os pontos \(P\) e \(Q\) são iguais, o ponto \(R\) é resultado de</p> \[R=P+Q=P+P=2P\] <p>Vamos visualizar geometricamente:</p> <p>Suponha que existam dois pontos \(P\neq Q\in E\) arbitrariamente próximos e que é traçada um reta secante passando por \(P \ e \ Q\).</p> <p>Imagine que o ponto \(Q\) vai se aproximando cada vez mais de \(P\), e que isso acontece de tal maneira que a distância final entre eles seja infinitesimal.</p> <p>Assim, os pontos \(P, Q\) vão coincidir e a reta só tocará o ponto \(P\).</p> <p>Imagem meramente ilustrativa de uma parábola. Não representa uma curva elíptica.</p> <p>Essa reta é a Reta Tangente, que também tem equação</p> \[y=sx+m\] <p>Dessa vez, o coeficiente angular é dado pela derivada de</p> \[y^2=x^3+ax+b\] <p>Para isso, vamos derivar primeiro para \(y&gt;0\):</p> \[y=\sqrt{x^3+ax+b}\] \[\frac{dy}{dx}=\frac{d}{dx}(\sqrt{x^3+ax+b})\] \[\frac{dy}{dx}=\frac{d}{dx}(x^3+ax+b)^\frac{1}{2}\] <p>Aplica-se a Regra da Cadeia:</p> \[\frac{dy}{dx}=\frac{1}{2}(x^3+ax+b)^{-\frac{1}{2}}\cdot(3x^2+a)\] \[\frac{dy}{dx}=\frac{1}{2\sqrt{x^3+ax+b}}\cdot(3x^2+a)\] <p>Por fim, é substituido o valor conhecido de \(y=\sqrt{x^3+ax+b}\)</p> \[\frac{dy}{dx}=\frac{1}{2y}\cdot(3x^2+a)\] <p>Como \(2y\) já leva em consideração o sinal de \(y\), não é necessário derivar para \(y&lt;0\).</p> \[s=\frac{3x^2+a}{2y}\] <p>Dadas as as equações de \(x_R\ e\ y_R\), basta substituir o valor de \(s\).</p> \[x_R=s^2-x_P-x_Q\] <p>Mas \(P=(x_P,y_P)=Q\):</p> \[x_R=s^2-2x_P\] <p>Para \(y_R\) não é necessário realizar alterações na fórmula:</p> \[y_R=s(x_P-x_R)-y_P\] <h3 id="43-elemento-neutro-do-grupo-o">4.3. Elemento Neutro do Grupo \((O)\):</h3> <p>E se a reta que passa por \(P \text{ e } Q\) for vertical ao eixo x?</p> <p>Esse cenário ocorre quando \(P=(x,y) \text{ e } Q=(x,-y)\).</p> <p>Para isso, é definido um ponto no infinito do eixo \(y\) , denotado por \(O\). Podemos imaginar uma estrada que vai até o infinito, já que as margens são retas paralelas e se encontram no horizonte.</p> <p>P+Q=P+(-P)=O</p> <p>Estrada que vai até o infinito.</p> <p>Esse ponto no infinito é o elemento neutro do Grupo Aditivo, isso significa que</p> \[P+O=P,\ \forall P\in E\] <p>Ou ainda,</p> \[P+(-P)=O\] <p>Lembrando que, por definição \(-P=(x_P,-y_P)\), mas em \(ℤ_p\) é dado por</p> \[-P=(x_P,p-y_P) \mod p\] <p>Imagem meramente ilustrativa de uma parábola. Não representa uma curva elíptica.</p> <p>Essa reta é a Reta Tangente, que também tem equação</p> \[y=sx+m\] <p>Dessa vez, o coeficiente angular é dado pela derivada de</p> \[y^2=x^3+ax+b\] <p>Para isso, vamos derivar primeiro para \(y&gt;0\):</p> \[y=\sqrt{x^3+ax+b}\] \[\frac{dy}{dx}=\frac{d}{dx}(\sqrt{x^3+ax+b})\] \[\frac{dy}{dx}=\frac{d}{dx}(x^3+ax+b)^\frac{1}{2}\] <p>Aplica-se a Regra da Cadeia:</p> \[\frac{dy}{dx}=\frac{1}{2}(x^3+ax+b)^{-\frac{1}{2}}\cdot(3x^2+a)\] \[\frac{dy}{dx}=\frac{1}{2\sqrt{x^3+ax+b}}\cdot(3x^2+a)\] <p>Por fim, é substituido o valor conhecido de \(y=\sqrt{x^3+ax+b}\)</p> \[\frac{dy}{dx}=\frac{1}{2y}\cdot(3x^2+a)\] <p>Como \(2y\) já leva em consideração o sinal de \(y\), não é necessário derivar para \(y&lt;0\).</p> \[s=\frac{3x^2+a}{2y}\] <p>Dadas as as equações de \(x_R\ e\ y_R\), basta substituir o valor de \(s\).</p> \[x_R=s^2-x_P-x_Q\] <p>Mas \(P=(x_P,y_P)=Q\):</p> \[x_R=s^2-2x_P\] <p>Para \(y_R\) não é necessário realizar alterações na fórmula:</p> \[y_R=s(x_P-x_R)-y_P\] <h3 id="43-elemento-neutro-do-grupo-o-1">4.3. Elemento Neutro do Grupo \((O)\):</h3> <p>E se a reta que passa por \(P \text{ e } Q\) for vertical ao eixo x?</p> <p>Esse cenário ocorre quando \(P=(x,y) \text{ e } Q=(x,-y)\).</p> <p>Para isso, é definido um ponto no infinito do eixo \(y\) , denotado por \(O\). Podemos imaginar uma estrada que vai até o infinito, já que as margens são retas paralelas e se encontram no horizonte.</p> <p>P+Q=P+(-P)=O</p> <p>Estrada que vai até o infinito.</p> <p>Esse ponto no infinito é o elemento neutro do Grupo Aditivo, isso significa que</p> \[P+O=P,\ \forall P\in E\] <p>Ou ainda,</p> \[P+(-P)=O\] <p>Lembrando que, por definição \(-P=(x_P,-y_P)\), mas em \(ℤ_p\) é dado por</p> \[-P=(x_P,p-y_P) \mod p\] <h3 id="teorema-2">Teorema 2:</h3> <p>Os pontos de uma curva elíptica \(E\ (O\) incluso\()\) tem subgrupos cíclicos. Sob algumas condições, todos os pontos de \(E\) formam um Grupo Cíclico.</p> <h3 id="teorema-3">Teorema 3:</h3> <p>Se \(G\) é um grupo finito e cíclico com \(\#G\) primo, então todos os elementos \(a\neq 1 \in G\) são geradores.</p> <h3 id="teorema-4-teorema-de-hasse">Teorema 4 (Teorema de Hasse):</h3> <p>Dada uma curva elíptica \(E\) em \(ℤ_{p}\ ,\ p&gt;3\), o número de pontos na curva é denotado por \(\# E\) e é limitado por:</p> \[p+1-2\sqrt{p}\leq\#E\leq p+1+2\sqrt{p}\] <p>Para um \(p\) suficientemente grande,</p> \[\#E\approx p\] <h3 id="44-exemplo-prático-understanding-cryptography---christof-paar-jan-pelzl">4.4. Exemplo Prático (Understanding Cryptography - Christof Paar, Jan Pelzl):</h3> <p>Seja a curva elíptica \(E:y^2\equiv x^3+2x+2 \mod 17\):</p> <p>O valor de \(\#E\) pode ser calculado de forma exata com o <strong><a href="https://www.math.ttu.edu/~mccarthy/publications/TraceFrob.pdf">traço de Frobenius</a></strong>, mas a conta é muito extensa, além de complicada. Fazendo a conta previamente, \(\#E=19\).</p> <p>Sabendo que \(\#E\) é primo, vale o Teorema 3 e qualquer ponto da curva é um gerador.</p> <p>Vamos verificar se \(P=(5,1)\) pertence a curva:</p> \[y^2 - x^3 - 2x-2 \equiv 0 \mod17\] \[1^2 - 5^3 - 2(5)-2 \equiv 0 \mod17\] \[1 -125-10-2 \equiv 0 \mod17\] \[136\equiv 0 \mod 17\] <p>Como \(136 \div17=8\), a congruência é verdadeira, e portanto \(P \in E\).</p> <p>A partir do gerador \(P=(5,1)\), vamos computar as adições de \(P\) até chegar no elemento neutro, i.e., \(\#E.\)</p> <p>Vou fazer manualmente a soma \(2P\) para fixar o conteúdo:</p> \[s\equiv(3x_P^2+a)(2y_P)^{-1} \mod17\] \[s\equiv(3(5)^2+2)(2)^{-1} \mod17\] \[s\equiv(3\cdot 25+2) \cdot 9\mod17\] \[s\equiv 13\mod17\] \[x_R\equiv s^2-2x_P \mod 17\] \[y_R\equiv s(x_P-x_R)-y_P \mod 17\] \[x_R\equiv (13)^2-2\cdot 5 \mod 17\] \[y_R\equiv 13(5-6)-1 \mod 17\] \[x_R\equiv 6\mod 17\] \[y_R\equiv 3\mod 17\] \[2P=(6,3)\] <p>E assim segue,</p> \[2P=(6,3)\\\] \[3P=2P+P=(10,6) \\\] \[4P=3P+P=(3,1) \\\] \[5P=(9,16) \\\] \[6P=(16,13)\\\] \[7P=(0,6)\\\] \[8P=(13,7)\\\] \[9P=(7,6)\\\] \[10P=(7,11)\] \[11P=(13,10)\\\] \[12P=(0,11)\\\] \[13P=(16,4)\\\] \[14P=(9,1)\\\] \[15P=(3,16)\\\] \[16P=(10,11)\\\] \[17P=(6,14)\\\] \[18P=(5,16)=(5,-1)=-P\\\] \[19P=P+(-P)=O\] <p>Perceba que, \(18P=-P\), porque \(16 \equiv -1 \mod 17\), e por definição</p> \[-P=(x_P,-y_P)\] <p>Visto que o elemento neutro \(O\) é definido como \(P+(-P)\), então</p> \[19P = P + (-P) = O\] <p>Você pode verificar esses resultados com o código abaixo:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">add_PQ</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
    <span class="n">O</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># Python não compreende um elemento neutro no infinito, portanto usamos a origem.
</span>    <span class="k">if</span> <span class="n">P</span> <span class="o">==</span> <span class="n">O</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Q</span>
    <span class="k">if</span> <span class="n">Q</span> <span class="o">==</span> <span class="n">O</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">P</span>
    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">P</span>
    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">Q</span>
    <span class="k">if</span> <span class="n">x1</span> <span class="o">==</span> <span class="n">x2</span> <span class="ow">and</span> <span class="n">y1</span> <span class="o">==</span> <span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="n">y2</span><span class="p">)</span> <span class="o">%</span> <span class="n">p</span><span class="p">:</span>
      <span class="k">return</span> <span class="n">O</span>
    <span class="k">if</span> <span class="n">P</span> <span class="o">!=</span> <span class="n">Q</span><span class="p">:</span>
        <span class="n">s</span> <span class="o">=</span> <span class="p">((</span><span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span><span class="p">)</span> <span class="o">*</span> <span class="nf">pow</span><span class="p">(</span><span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="p">))</span> <span class="o">%</span> <span class="n">p</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">s</span> <span class="o">=</span> <span class="p">((</span><span class="mi">3</span> <span class="o">*</span> <span class="n">x1</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a</span><span class="p">)</span> <span class="o">*</span> <span class="nf">pow</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">y1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="p">))</span> <span class="o">%</span> <span class="n">p</span>
    <span class="n">x3</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">x2</span><span class="p">)</span> <span class="o">%</span> <span class="n">p</span>
    <span class="n">y3</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span> <span class="o">*</span> <span class="p">(</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x3</span><span class="p">)</span> <span class="o">-</span> <span class="n">y1</span><span class="p">)</span> <span class="o">%</span> <span class="n">p</span>
    <span class="k">return</span> <span class="n">x3</span><span class="p">,</span> <span class="n">y3</span>

<span class="k">def</span> <span class="nf">encontra_nP</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
    <span class="c1"># Double-and-add algorithm
</span>    <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">addend</span> <span class="o">=</span> <span class="n">P</span>
    <span class="k">while</span> <span class="n">k</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">k</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="nf">add_PQ</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">addend</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
        <span class="n">addend</span> <span class="o">=</span> <span class="nf">add_PQ</span><span class="p">(</span><span class="n">addend</span><span class="p">,</span> <span class="n">addend</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
        <span class="n">k</span> <span class="o">//=</span> <span class="mi">2</span>
    <span class="k">return</span> <span class="n">result</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">19</span><span class="p">):</span>
		<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s">P = </span><span class="si">{</span><span class="nf">encontra_nP</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">17</span><span class="p">)</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div> <h3 id="45-resumo">4.5. Resumo:</h3> <p>Em geral, vale que na soma de dois pontos \(P=(x_P,y_P) \ e \ Q =(x_Q,y_Q)\) pertencentes a curva elíptica em \(ℤ_p,\ p&gt;3\):</p> \[P+Q=R=(x_R,y_R)\] \[x_R\equiv s^2-x_P-x_Q \mod p\] \[y_R\equiv s(x_P-x_R)-y_P \mod p\] \[s=\begin{cases} (y_Q-y_P)\cdot(x_Q-x_P)^{-1} \mod p, &amp; \text{se } P\neq Q\\ ({3x_P}^2+a)\cdot(2y_P)^{-1} \mod p,&amp; \text{se } P=Q \end{cases}\] <h2 id="5-variante-de-menezes-e-vanstone-para-o-elgamal">5. Variante de Menezes e Vanstone para o ElGamal</h2> <p>Em 1985, o Criptógrafo Taher Elgamal criou um sistema de criptografia baseado no <strong>Problema do Logaritmo Discreto</strong> em Curvas Elípticas, que usa um mecanismo público de acordo de chaves, o <strong><em>Diffie-Hellman</em></strong>.</p> <p>Dez anos depois, os matemáticos Alfred Menezes e Scott Vanstone elaboraram uma versão alternativa para o ElGamal em que não é necessário pré-codificar a mensagem como um ponto na curva. Esse sistema não altera a segurança da criptografia e, por isso, vou usar como exemplo de Criptografia de Curvas Elípticas nesse material.</p> <h3 id="51-problema-do-logaritmo-discreto-em-curvas-elípticas">5.1. Problema do Logaritmo Discreto em Curvas Elípticas:</h3> <p>Dada uma curva elíptica \(E\) em \(ℤ_{p}\ ,\) para um \(p\) muito grande. Consideramos um gerador \(P \in E\), de ordem grande \((\# E)\).</p> <p>A chave pública desse sistema é:</p> \[pub\_{key}=(ℤ_{p}, E,P)\] <p>Já a chave privada vem do problema do logaritmo discreto,</p> \[T=\underbrace{P+P+\dots+P+P+P}_\text{n vezes}=nP\] <p>A dificuldade de decriptar uma mensagem se dá em encontrar \(n\) e, posteriormente, o seu inverso multiplicativo em \(ℤ_{p}\).</p> \[priv\_key=n\] <p>Veremos que, quando aplicamos o Diffie-Hellman esse problema tem o dobro de dificuldade, porque não será apenas um \(n\) a ser encontrado. Na verdade, o atacante precisaria encontrar os inteiros \(n_A, n_B\) a partir do gerador \(P\) e pontos \(A, B\) divulgados.</p> \[A=n_A P\] \[n_A=\log_{P}A\] \[B=n_B P\] \[n_B=\log_{P}B\] <h3 id="52-diffie-hellman-troca-de-chaves">5.2. Diffie-Hellman (Troca de Chaves):</h3> <p>Suponha que dois amigos Alice e Bob querem testar essa criptografia em um canal público.</p> <p>Eles precisam entrar em consenso em quais serão as chaves pública e privada, e para isso, Alice e Bob escolhem um inteiro \(n_A\) e \(n_B\) como suas chaves privadas.</p> <p>Alice e Bob encontram os pontos \(A \ e \ B\) e trocam essa informação no canal público.</p> \[A={n_A}P\] \[B={n_B}P\] <p>Com esses segredos compartilhados em mãos, cada um obtém um novo ponto \(T\) da curva que será usado para encriptar a mensagem:</p> \[T=n_BA=n_AB=n_A\ n_B \ P=(x_T,y_T)\] <p>Nesse teste, Alice vai enviar a mensagem \(m\) para Bob, mas não é possível encriptar uma mensagem do tipo <strong><em>string</em></strong> sem qualquer pré-codificação.</p> <h3 id="53-pré-codificação-da-mensagem">5.3. Pré-Codificação da Mensagem:</h3> <p>Existem algumas formas de pré-codificar uma mensagem, mas a mais simples e intuitiva é utilizando a tabela ASCII. Cada caractere da mensagem \(m\) vai ser mapeado para um número decimal.</p> <p>Tabela ASCII. Retirado de asciicharstable.com</p> <p>Por exemplo, a mensagem \(m=\text{"Processo Seletivo GRIS"}\) após conversão para tabela ASCII se torna</p> \[\underbrace{080}_\text{P}\underbrace{114}_\text{r} \underbrace{111}_\text{o}\underbrace{099}_\text{c}\underbrace{101}_\text{e}\underbrace{115}_\text{s}\underbrace{115}_\text{s}\underbrace{111}_\text{o}\underbrace{032}_\text{" "}\underbrace{083}_\text{S}\underbrace{101}_\text{e}\underbrace{108}_\text{l}\underbrace{101}_\text{e}\underbrace{116}_\text{t}\underbrace{105}_\text{i}\underbrace{118}_\text{v}\underbrace{111}_\text{o}\underbrace{032}_\text{ " " }\underbrace{071}_\text{G}\underbrace{082}_\text{R}\underbrace{073}_\text{I}\underbrace{083}_\text{S}\] <p>Contudo, ainda falta tornar essa mensagem um ponto no plano cartesiano, que será feito ao quebrar em dois essa mensagem codificada, sempre com cautela para o valor de \(y\) não comece com zero.</p> \[m= (m_1,m_2)=(80114111099101115115111032083101,108101116105118111032071082073083)\] <h3 id="54-encriptando-e-decriptando-a-mensagem">5.4. Encriptando e Decriptando a Mensagem:</h3> <p>Como, Alice e Bob já trocaram suas chaves na etapa do Diffie-Hellman e ambos já possuem \(T\), Alice encripta a mensagem \(m\) em um simples passo.</p> \[x_S\equiv x_T \cdot m_1 \mod p\] \[y_S\equiv y_T \cdot m_2 \mod p\] <p>Ela envia a mensagem encriptada \((x_S,y_S)\) para Bob, que por sua vez, pode decriptar a mensagem ao encontrar o inverso multiplicativo de \(x_T \ e \ y_T\) em \(ℤ_{p}\)</p> \[x_T^{-1} \cdot x_S\equiv x_T^{-1} \cdot x_T\cdot m_1 \equiv m_1 \mod p\] \[y_T^{-1} \cdot y_S\equiv y_T^{-1} \cdot y_T\cdot m_2 \equiv m_2 \mod p\] <h3 id="55-exemplo">5.5. Exemplo:</h3> <p>Alice e Bob decidiram a chave pública em seu canal de comunicação:</p> \[p= 6846869858332693264879382366866797734569\] \[E:y^2\equiv x^3+x+1 \mod p\] \[P=(0,1)\] <p>Eles geram dois números inteiros grandes “aleatórios” para suas chaves privadas na etapa de Diffie-Hellman, calculam \(A={n_A}P \text{ e } \ B={n_B}P\) e enviam pelo canal esses pontos da curva:</p> \[n_A=394756376\] \[n_B=4857628576\] \[A=n_AP\\\] \[B={n_B}P\] \[A=(1321558335145962274111597490867211013255,\] \[4651129240009681064199578869499137918033)\] \[B=(4220619002574924415163949286290416539523,\] \[1790760103048364272577275779143881254580)\] <p>Para Alice enviar a mensagem \(m=\text{"Processo Seletivo GRIS"}\), ela deve primeiro calcular \(T=n_AB\)</p> \[T=(3388592562391724595268718829924043980213,\] \[129495594649667554566611905764330384728)\] <p>Com a mensagem devidamente codificada com a tabela ASCII, basta Alice encontrar o ponto \(S\), que é a mensagem encriptada na curva.</p> \[x_S\equiv x_T\cdot m_1 \mod p\] \[y_S \equiv y_T \cdot m_2 \mod p\] \[x_S\equiv 4529049851661077032801780682798255617077 \mod p\] \[y_S\equiv 1642634166139862032990613753379881067558 \mod p\] <p>Bob recebe o ponto \(S=(x_S,y_S)\) e decripta com a chave privada \(T\).</p> \[m_1=80114111099101115115111032083101\] \[m_2=108101116105118111032071082073083\] <p>Para transformar de volta em texto, Bob junta as coordenadas \(m_1 \text{ e } m_2\) em uma única string e faz um slice de três em três posições convertendo o código ASCII (que sempre têm três dígitos, apesar de alguns apresentarem um 0 na frente) para caractere.</p> \[m=\text{"Processo Seletivo GRIS"}\] <h2 id="6-assinatura-digital-ecdsa">6. Assinatura Digital (ECDSA):</h2> <p>Uma assinatura digital tem como propósito identificar o Autor de uma mensagem de forma única, ou seja, somente o autor pode ser capaz de gerar sua assinatura digital. Assim, ele não pode negar a autoria da mensagem.</p> <p>Existem alguns algoritmos de assinatura digital, mas atualmente Criptografias de Curvas Elípticas são amplamente utilizadas com esse propósito, principalmente porque elas usam chaves de menor tamanho e são mais ágeis.</p> <p>ECDSA (”Algoritmo de Assinatura Digital em Curvas Elípticas” em pt-BR) é implementado desde a infraestrutura do certificado de segurança SSL e TLS, até endereços de Bitcoins.</p> <h3 id="61-algoritmo">6.1. Algoritmo:</h3> <p>Suponha que os dois amigos Alice e Bob queiram testar agora o ECDSA. Para isso, eles devem concordar nos parâmetros da curva:</p> \[(E, \ P, \ p)\] <p>onde \(P\) é um gerador em que a \(n=ord(P)\) atenda duas condições importantes:</p> \[ord(P)=\#E\] \[ord(P) \text{ é primo}\] <p>Alice vai mandar a mesma mensagem \(m=\text{"Processo Seletivo GRIS"}\), só que desta vez ela vai assinar usando ECDSA, que ela faz da seguinte forma:</p> <p>Ela gera um número inteiro \(d_A\) aleatório do intervalo \([1, n-1]\) como sua chave privada e calcula o ponto da curva \(Q_{A}=d_A\times P\) como chave pública. Com isso em mãos, ela vai seguir o algoritmo abaixo</p> \[\text{1. Calcule a hash dessa mensagem:} \ e= \text{HASH}(m)\\\] \[\text{2. Considere } z \text{ como os } L_n \text{ bits mais à esquerda de } e \text{,}\\ \text{ onde } L_n \text{ é o comprimento de bit de ord(P)}\] \[\text{3. Escolha k no intervalo } [1, n-1] \text{}\] \[\text{4. Calcule } (x_1,y_1)=k\times P\] \[\text{5. Calcule } r\equiv x_1 \mod n \text{ e se r=0, volte para a etapa 3}\] \[\text{6. Calcule } s\equiv k^{-1} (z+r\cdot d_A) \mod n \text{ e se s=0, volte para a etapa 3}\] <p>No final desse processo, Alice obtém o par \((r,s)\) que é a sua assinatura digital em ECDSA.</p> <h3 id="62-verificação-de-assinatura">6.2. Verificação de Assinatura:</h3> <p>Após Bob receber a mensagem com a assinatura de Alice, ele pode autenticar a mesma utilizando a chave pública previamente acordada.</p> <p>Antes de tudo, ele verifica se \(Q_A \in E\) ao calcular \(n\times Q_A\). Se resultar no elemento neutro \(O\) , a assinatura é autentica. Entretando, Bob ainda tem que descobrir se essa assinatura pertence a Alice.</p> \[\text{1. Verifica se } r,s\in[1,n-1]\] \[\text{2. Calcule } e=\text{HASH}(m)\] \[\text{3. Considere z como os } L_n \text{ bits mais à esquerda de } e\] \[\text{4. Encontre o inverso multiplicativo de } s \text{ em } ℤ_n: w\equiv s^{-1} \mod n\] \[\text{5. Calcule } u_1 = zw \mod n \text{ e } u_2\equiv rw \mod n\] \[\text{6. Calcule o ponto da curva } (x_1,y_1)=u_1\times P+u_2\times Q_A, \text{ se } (x_1,y_1)=O \text{ é invalida}\] \[\text{7. Se } r\equiv x_1\mod n \text{, a assinatura é valida}\] <h3 id="63-ps3-jailbreak---fail0verfl0w">6.3. PS3 Jailbreak - fail0verfl0w:</h3> <p>Se um mesmo \(k\) for usado para assinar duas mensagens distintas, é possível recuperar a chave privada do autor através de algumas simples operações.</p> <p>Lembrando que, \(k\) igual para duas assinaturas implica em \(r\) ser o mesmo também, visto que</p> \[r=(k\times P)_x \mod n\] <p>Contudo, \(k\) igual não implica em \(s\) iguais para duas assinaturas. Na verdade, esse fato dá brecha para um ataque.</p> <p>Suponha que temos duas mensagens diferentes de hashes \(z_1 \text{ e } z_2\), respectivamente. O inverso multiplicativo de \(k\) continua sendo o mesmo, tanto para \(s_1\) quanto para \(s_2\), assim como \(rd_A\).</p> \[s_1\equiv((z_1+rd_A)\cdot k^{-1}) \mod n\] \[s_2\equiv((z_2+rd_A)\cdot k^{-1}) \mod n\] <p>Assim, com uma simples manipulação algébrica,</p> \[s_1-s_2\equiv((z_1+rd_A)\cdot k^{-1})-((z_2+rd_A)\cdot k^{-1}) \mod n\] \[(z_1+rd_A-z_2-rd_A)\cdot k^{-1} \equiv(z_1-z_2)\cdot k^{-1} \mod n\] <p>Mas isso tudo é congruente a diferença de \(s_1\) e \(s_2\)</p> \[(s_1-s_2)\equiv (z_1-z_2)\cdot k^{-1} \mod n\] <p>Multiplicando \(k\) de ambos os lados,</p> \[(s_1-s_2)\cdot k\equiv (z_1-z_2) \mod n\] <p>Sendo assim, \(k\) pode ser facilmente obtido com o cálculo abaixo:</p> \[k\equiv (z_1-z_2)\cdot(s_1-s_2)^{-1} \mod n\] <p>Com \(k\) em mãos, é possível colocar \(d_A\) em evidência a partir da congruência</p> \[s_1\equiv((z_1+rd_A)\cdot k^{-1}) \mod n\] <p>Novamente, multiplica-se \(k\) de ambos os lados,</p> \[(z_1+rd_A)\equiv s_1 \cdot k\mod n\] \[rd_A\equiv (s_1 \cdot k -z_1) \mod n\] <p>Portanto, a chave privada é a solução de</p> \[d_A\equiv (s_1 \cdot k - z_1) \cdot r^{-1} \mod n\] <h2 id="7-posts">7. POSTs:</h2> <p>Para o POST de vocês, elaborei 3 challs de níveis <strong><em>fácil</em></strong>, <strong><em>médio</em></strong> e <strong><em>médio plus</em></strong>.</p> <p>Tudo que você precisa para resolver esses POSTs está nesse material, basta procurar com atenção.</p> <p>No geral estão bem tranquilos, não fiquem assustados pelo tamanho do material, porque eu garanti que vocês não vão precisar escrever mais do que três linhas de código no Python para pegar a flag. Caso não tenham instalado Python no computador ainda, vocês podem passar esse código para o <a href="https://colab.research.google.com/">https://colab.research.google.com</a> e obter a flag por ali.</p> <p>Além disso, eu escolhi não colocar os números nos enunciados abaixo e sim direto no código, porque são muito grandes e pode acabar confundindo na hora de ler o comando da questão, então não se preocupem em copiar eles, já está tudo no arquivo .py.</p> <p>Vocês podem me consultar a qualquer momento, até mesmo para auxílio na linguagem Python.</p> <p>Boa Sorte! =D</p> <p><strong>ATENÇÃO: TODAS AS FLAGS ESTÃO NO FORMATO CTF-BR{flag}</strong></p> <h3 id="71-onde-está-stuart-little-fácil">7.1. Onde está Stuart Little? <strong>(Fácil)</strong></h3> <p>Três ratos foram fazer um passeio em uma Curva Elíptica</p> \[E:y^2\equiv x^3-3x+4 \mod 43\] <p>Stuart Little se perdeu de seus amigos Mickey e Jerry, e eles precisam de ajuda para encontrá-lo.</p> <p>Sabendo que Mickey está no ponto \(P=(14,37)\), Jerry no ponto \(Q=(14,-37)\), e que a soma \(P+Q\) é onde o Stuart Little está, responda o ponto (em caps-lock) que representa a posição de Stuart Little.</p> <p>Por exemplo, se Stuart Little estivesse no ponto \(S\), vocês responderiam \(\text{CTF-BR{S}}\)</p> <h3 id="72-elgaton-médio">7.2. ElGaton <strong>(Médio)</strong></h3> <p>(Não se preocupem em copiar esses números para o código, já coloquei no arquivo .py)</p> <p>Meu gato Frodo implementou um novo sistema de criptografia baseado em curvas elípticas chamado ElGaton (qualquer semelhança com o ElGamal é apenas uma mera coincidência 🤫).</p> <p>Frodo quer usar o ElGaton para se comunicar com meu outro gato Sam, e eu descobri que a chave pública dessa criptografia é:</p> <ul> <li>A curva elíptica \(E: y^2 \equiv x^3+ax+b \mod p\)</li> <li>O módulo primo \(p\)</li> <li>O gerador \(P\)</li> </ul> <p>Eu consegui interceptar uma das mensagens trocadas entre eles e, enquanto isso, meu outro gato Gollum encontrou o segredo compartilhado do Sam e a chave privada do Frodo para o Diffie-Hellman:</p> <ul> <li> $$Q_{sam}=(246061765250195212969506118903120091083185433952208069588975, $$ </li> $$ 9343754362889750569766954041373414358787687742337204027292453) $$ <li> $$n_{frodo}=233336110442550297617299$$ </li> </ul> <p>Lembrando que</p> \[Q_{sam}\equiv n_{sam} \cdot P \mod p\] <p>Você pode me ajudar a decriptar a mensagem?</p> \[S=(109105097117095109051048119095109101048119095109105052117,\] \[95109051111119095109101111119095109049097117095109049052117)\] <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">Crypto.Util.number</span> <span class="kn">import</span> <span class="n">long_to_bytes</span>
<span class="k">def</span> <span class="nf">add_PQ</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
  <span class="n">O</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">P</span> <span class="o">==</span> <span class="n">O</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">Q</span>
  <span class="k">if</span> <span class="n">Q</span> <span class="o">==</span> <span class="n">O</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">P</span>
  <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">P</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">P</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
  <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">Q</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Q</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

  <span class="k">if</span> <span class="n">x1</span> <span class="o">==</span> <span class="n">x2</span> <span class="ow">and</span> <span class="n">y1</span> <span class="o">==</span> <span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="n">y2</span><span class="p">)</span> <span class="o">%</span> <span class="n">p</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">O</span>

  <span class="k">if</span> <span class="n">P</span> <span class="o">!=</span> <span class="n">Q</span><span class="p">:</span>
    <span class="n">s</span> <span class="o">=</span> <span class="p">((</span><span class="n">y2</span><span class="o">-</span><span class="n">y1</span><span class="p">)</span> <span class="o">*</span> <span class="nf">pow</span><span class="p">(</span><span class="n">x2</span><span class="o">-</span><span class="n">x1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="p">))</span> <span class="o">%</span> <span class="n">p</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">s</span> <span class="o">=</span> <span class="p">((</span><span class="mi">3</span> <span class="o">*</span> <span class="n">x1</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="nf">pow</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">y1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="p">))</span> <span class="o">%</span> <span class="n">p</span>
  <span class="n">x3</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">x2</span><span class="p">)</span> <span class="o">%</span> <span class="n">p</span>
  <span class="n">y3</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span><span class="o">*</span><span class="p">(</span><span class="n">x1</span><span class="o">-</span><span class="n">x3</span><span class="p">)</span> <span class="o">-</span> <span class="n">y1</span><span class="p">)</span> <span class="o">%</span> <span class="n">p</span>
  <span class="k">return</span> <span class="n">x3</span><span class="p">,</span><span class="n">y3</span>

<span class="k">def</span> <span class="nf">encontra_nP</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">addend</span> <span class="o">=</span> <span class="n">P</span>
    <span class="k">while</span> <span class="n">k</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">k</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="nf">add_PQ</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">addend</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
        <span class="n">addend</span> <span class="o">=</span> <span class="nf">add_PQ</span><span class="p">(</span><span class="n">addend</span><span class="p">,</span> <span class="n">addend</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
        <span class="n">k</span> <span class="o">//=</span> <span class="mi">2</span>
    <span class="k">return</span> <span class="n">result</span>

<span class="c1"># Chave Pública
# y^2 = x^3 +ax +b (mod p)
</span><span class="n">a</span> <span class="o">=</span> <span class="mi">15347898055371580590890576721314318823207531963035637503096292</span>
<span class="n">b</span> <span class="o">=</span> <span class="mi">7444386449934505970367865204569124728350661870959593404279615</span>

<span class="n">P</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1619092589586542907492569170434842128165755668543894279235270</span><span class="p">,</span>
     <span class="mi">3436949547626524920645513316569700140535482973634182925459687</span><span class="p">)</span>

<span class="n">p</span> <span class="o">=</span> <span class="mi">17676318486848893030961583018778670610489016512983351739677143</span>

<span class="c1"># Mensagem Encriptada
</span><span class="n">S</span> <span class="o">=</span> <span class="p">(</span><span class="mi">334723336424414961000482608007001766504544326753246721049147</span><span class="p">,</span> <span class="mi">12254736703215694149846183808068667208423268069978932609288223</span><span class="p">)</span>

<span class="c1"># Diffie-Helmann
</span>
<span class="n">Q_sam</span><span class="o">=</span> <span class="p">(</span><span class="mi">246061765250195212969506118903120091083185433952208069588975</span><span class="p">,</span><span class="mi">9343754362889750569766954041373414358787687742337204027292453</span><span class="p">)</span>

<span class="n">n_frodo</span> <span class="o">=</span> <span class="mi">233336110442550297617299</span>

<span class="c1"># Altere SOMENTE esse trecho abaixo para obter a mensagem decriptada
# Um exemplo seria: 3P = encontra_nP(3,P,a,p)
</span><span class="n">T</span> <span class="o">=</span> <span class="nf">encontra_nP</span><span class="p">(</span><span class="n">INSIRA</span> <span class="n">OS</span> <span class="n">PARAMETROS</span> <span class="n">CORRETOS</span><span class="p">)</span>

<span class="n">dec_x</span> <span class="o">=</span> <span class="err">?</span>
<span class="n">dec_y</span> <span class="o">=</span> <span class="err">?</span>
<span class="c1"># Até aqui
</span>
<span class="c1"># Essa função retorna a flag, basta alterar o trecho acima e você terá a resposta =)
</span><span class="nf">print</span><span class="p">(</span><span class="nf">long_to_bytes</span><span class="p">(</span><span class="nf">int</span><span class="p">(</span><span class="nf">str</span><span class="p">(</span><span class="n">dec_x</span><span class="p">)</span><span class="o">+</span><span class="sh">""</span><span class="o">+</span><span class="nf">str</span><span class="p">(</span><span class="n">dec_y</span><span class="p">))))</span>
</code></pre></div></div> <h3 id="72-tem-na-primevideo-médio-plus">7.2. Tem na PrimeVideo <strong>(Médio Plus)</strong></h3> <p>Os dois amigos Alex e Rosie trocavam cartas todo mês, até que decidiram assinar digitalmente suas mensagens usando o ECDSA.</p> <p>Alex enviou duas mensagens para Rosie, mas propositalmente usou um mesmo \(k\) nessas assinaturas para que Rosie encontrasse sua chave privada. Ele disse que escondeu nessa chave um filme para assistirem juntos depois.</p> <p>Você pode ajudar Rosie a encontrar a chave \(d_A\)?</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">hashlib</span>

<span class="k">def</span> <span class="nf">sha1</span><span class="p">(</span><span class="n">mensagem</span><span class="p">):</span>
  <span class="n">m</span> <span class="o">=</span> <span class="n">hashlib</span><span class="p">.</span><span class="nf">sha1</span><span class="p">()</span>
  <span class="n">m</span><span class="p">.</span><span class="nf">update</span><span class="p">(</span><span class="n">mensagem</span><span class="p">.</span><span class="nf">encode</span><span class="p">(</span><span class="sh">'</span><span class="s">utf-8</span><span class="sh">'</span><span class="p">))</span>
  <span class="k">return</span> <span class="n">m</span><span class="p">.</span><span class="nf">hexdigest</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">get_flag</span><span class="p">(</span><span class="n">dA</span><span class="p">):</span>
  <span class="n">flagg</span> <span class="o">=</span> <span class="nf">str</span><span class="p">(</span><span class="n">dA</span><span class="p">)</span>
  <span class="n">flag</span> <span class="o">=</span> <span class="sh">""</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nf">len</span><span class="p">(</span><span class="n">flagg</span><span class="p">),</span> <span class="mi">3</span><span class="p">):</span>
    <span class="n">ascii_value</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">flagg</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">])</span>
    <span class="n">flag</span> <span class="o">+=</span> <span class="nf">chr</span><span class="p">(</span><span class="n">ascii_value</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">flag</span>

<span class="c1"># módulo n
</span><span class="n">n</span> <span class="o">=</span> <span class="mi">656563738156183614196284144218755562218717754449979872699851236361364842254951562533589572185811735734269627798779142529399297211938766368323781389974849197211221357383295846145542699614912769848476126126824744284474444862644897675458539907</span> <span class="c1"># módulo n
</span>
<span class="c1"># Assinatura Digital 1 (Perceba que r é igual para as duas assinaturas)
</span><span class="n">r</span><span class="o">=</span><span class="mi">95607856998428856962864667427230197797741826906987352066517618702726741034205788706243608221638336439218766183440425733114479831314017676199460278142286425537126711154511562912579612912784188540749745708743557963162626080980370058843390766</span>
<span class="n">s1</span><span class="o">=</span><span class="mi">165157211993616791859199000937589933684499917729542174996499818375298323939989753112300163308344922630103779318855607444007576610685510915409036097807215683429601907707404696743146600439769894499636383677085373291440501432136786127232184960</span>
<span class="n">mensagem1</span> <span class="o">=</span> <span class="sh">"</span><span class="s">There</span><span class="sh">'</span><span class="s">s the pangs of time, there</span><span class="sh">'</span><span class="s">s the undiscover</span><span class="sh">'</span><span class="s">d country from whose bourn no traveller returns, puzzles the native hue of resolution devoutly to be: that the unworthy takes, when he himself might his quietus make with and the respect that flesh is heir to, </span><span class="sh">'</span><span class="s">tis a consience of outrageous fortune, or not to be wish</span><span class="sh">'</span><span class="s">d. To die: to sleep to sleep to sleep; to suffer the spurns that makes calamity of something after death, the rub; for in that sleep; to sleep to sleep; to sleep; to sleep; to sleep to suf</span><span class="sh">"</span>

<span class="c1"># Assinatura Digital 2
</span><span class="n">r</span><span class="o">=</span><span class="mi">95607856998428856962864667427230197797741826906987352066517618702726741034205788706243608221638336439218766183440425733114479831314017676199460278142286425537126711154511562912579612912784188540749745708743557963162626080980370058843390766</span>
<span class="n">s2</span><span class="o">=</span><span class="mi">655257327074735825941539460803878702931540821094751678069186258593203560380164175950374129122241488762716003739831883556274219200303701610167842447024906266687095907769369448831845421539179487468728385173083899901112733508707733874252121923</span>
<span class="n">mensagem2</span> <span class="o">=</span> <span class="sh">"</span><span class="s">What down at the name of Sanders. (What down at the forest all by himself. It went like that, just buzzing, he climb the tree, there came to an open place was a large oak-tree, and as he had the forest, and in the middle of Sanders. (What does under it. So he began to climbed, and began to think. First of the tree, and lived under the top of there came to an open place in the only reason for making a bee. Then he thought another long time, and buzzing and as he climbed and he sang a buzzing-noise</span><span class="sh">"</span><span class="n">z1</span><span class="p">,</span><span class="n">z2</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="nf">sha1</span><span class="p">(</span><span class="n">mensagem1</span><span class="p">),</span> <span class="mi">16</span><span class="p">),</span> <span class="nf">int</span><span class="p">(</span><span class="nf">sha1</span><span class="p">(</span><span class="n">mensagem2</span><span class="p">),</span> <span class="mi">16</span><span class="p">)</span>

<span class="c1"># k = ?
</span>
<span class="c1"># dA = ?
</span>
<span class="c1"># Desafio acaba aqui! =)
</span><span class="n">flag</span><span class="o">=</span><span class="sh">"</span><span class="s">CTF-BR{</span><span class="sh">"</span><span class="o">+</span> <span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="nf">get_flag</span><span class="p">(</span><span class="n">dA</span><span class="p">)</span><span class="si">}</span><span class="sh">"</span> <span class="o">+</span> <span class="sh">"</span><span class="s">}</span><span class="sh">"</span>
<span class="nf">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</code></pre></div></div>]]></content><author><name></name></author><category term="Intermediário"/><category term="ECC"/><summary type="html"><![CDATA[Material Didático sobre Criptografia de Curvas Elípticas com toda a matemática necessária.]]></summary></entry><entry><title type="html">a post with code diff</title><link href="https://zezedp.github.io/blog/2024/code-diff/" rel="alternate" type="text/html" title="a post with code diff"/><published>2024-01-27T19:22:00+00:00</published><updated>2024-01-27T19:22:00+00:00</updated><id>https://zezedp.github.io/blog/2024/code-diff</id><content type="html" xml:base="https://zezedp.github.io/blog/2024/code-diff/"><![CDATA[<p>You can display diff code by using the regular markdown syntax:</p> <div class="language-markdown highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">```</span><span class="nl">diff
</span><span class="gh">diff --git a/sample.js b/sample.js
index 0000001..0ddf2ba
</span><span class="gd">--- a/sample.js
</span><span class="gi">+++ b/sample.js
</span><span class="p">@@ -1 +1 @@</span>
<span class="gd">-console.log("Hello World!")
</span><span class="gi">+console.log("Hello from Diff2Html!")</span>
<span class="p">```</span>
</code></pre></div></div> <p>Which generates:</p> <div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gh">diff --git a/sample.js b/sample.js
index 0000001..0ddf2ba
</span><span class="gd">--- a/sample.js
</span><span class="gi">+++ b/sample.js
</span><span class="p">@@ -1 +1 @@</span>
<span class="gd">-console.log("Hello World!")
</span><span class="gi">+console.log("Hello from Diff2Html!")
</span></code></pre></div></div> <p>But this is difficult to read, specially if you have a large diff. You can use <a href="https://diff2html.xyz/">diff2html</a> to display a more readable version of the diff. For this, just use <code class="language-plaintext highlighter-rouge">diff2html</code> instead of <code class="language-plaintext highlighter-rouge">diff</code> for the code block language:</p> <div class="language-markdown highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">```</span><span class="nl">diff2html
</span><span class="sb">diff --git a/sample.js b/sample.js
index 0000001..0ddf2ba
--- a/sample.js
+++ b/sample.js
@@ -1 +1 @@
-console.log("Hello World!")
+console.log("Hello from Diff2Html!")</span>
<span class="p">```</span>
</code></pre></div></div> <p>If we use a longer example, for example <a href="https://github.com/rtfpessoa/diff2html/commit/c2c253d3e3f8b8b267f551e659f72b44ca2ac927">this commit from diff2html</a>, it will generate the following output:</p> <pre><code class="language-diff2html">From 2aaae31cc2a37bfff83430c2c914b140bee59b6a Mon Sep 17 00:00:00 2001
From: Rodrigo Fernandes &lt;rtfrodrigo@gmail.com&gt;
Date: Sun, 9 Oct 2016 16:41:54 +0100
Subject: [PATCH 1/2] Initial template override support

---
 scripts/hulk.js                    |  4 ++--
 src/diff2html.js                   |  3 +--
 src/file-list-printer.js           | 11 ++++++++---
 src/hoganjs-utils.js               | 29 +++++++++++++++++------------
 src/html-printer.js                |  6 ++++++
 src/line-by-line-printer.js        |  6 +++++-
 src/side-by-side-printer.js        |  6 +++++-
 test/file-list-printer-tests.js    |  2 +-
 test/hogan-cache-tests.js          | 18 +++++++++++++++---
 test/line-by-line-tests.js         |  3 +--
 test/side-by-side-printer-tests.js |  3 +--
 11 files changed, 62 insertions(+), 29 deletions(-)

diff --git a/scripts/hulk.js b/scripts/hulk.js
index 5a793c18..a4b1a4d5 100755
--- a/scripts/hulk.js
+++ b/scripts/hulk.js
@@ -173,11 +173,11 @@ function namespace(name) {
 // write a template foreach file that matches template extension
 templates = extractFiles(options.argv.remain)
   .map(function(file) {
-    var openedFile = fs.readFileSync(file, 'utf-8');
+    var openedFile = fs.readFileSync(file, 'utf-8').trim();
     var name;
     if (!openedFile) return;
     name = namespace(path.basename(file).replace(/\..*$/, ''));
-    openedFile = removeByteOrderMark(openedFile.trim());
+    openedFile = removeByteOrderMark(openedFile);
     openedFile = wrap(file, name, openedFile);
     if (!options.outputdir) return openedFile;
     fs.writeFileSync(path.join(options.outputdir, name + '.js')
diff --git a/src/diff2html.js b/src/diff2html.js
index 21b0119e..64e138f5 100644
--- a/src/diff2html.js
+++ b/src/diff2html.js
@@ -7,7 +7,6 @@

 (function() {
   var diffParser = require('./diff-parser.js').DiffParser;
-  var fileLister = require('./file-list-printer.js').FileListPrinter;
   var htmlPrinter = require('./html-printer.js').HtmlPrinter;

   function Diff2Html() {
@@ -43,7 +42,7 @@

     var fileList = '';
     if (configOrEmpty.showFiles === true) {
-      fileList = fileLister.generateFileList(diffJson, configOrEmpty);
+      fileList = htmlPrinter.generateFileListSummary(diffJson, configOrEmpty);
     }

     var diffOutput = '';
diff --git a/src/file-list-printer.js b/src/file-list-printer.js
index e408d9b2..1e0a2c61 100644
--- a/src/file-list-printer.js
+++ b/src/file-list-printer.js
@@ -8,11 +8,16 @@
 (function() {
   var printerUtils = require('./printer-utils.js').PrinterUtils;

-  var hoganUtils = require('./hoganjs-utils.js').HoganJsUtils;
+  var hoganUtils;
+
   var baseTemplatesPath = 'file-summary';
   var iconsBaseTemplatesPath = 'icon';

-  function FileListPrinter() {
+  function FileListPrinter(config) {
+    this.config = config;
+
+    var HoganJsUtils = require('./hoganjs-utils.js').HoganJsUtils;
+    hoganUtils = new HoganJsUtils(config);
   }

   FileListPrinter.prototype.generateFileList = function(diffFiles) {
@@ -38,5 +43,5 @@
     });
   };

-  module.exports.FileListPrinter = new FileListPrinter();
+  module.exports.FileListPrinter = FileListPrinter;
 })();
diff --git a/src/hoganjs-utils.js b/src/hoganjs-utils.js
index 9949e5fa..0dda08d7 100644
--- a/src/hoganjs-utils.js
+++ b/src/hoganjs-utils.js
@@ -8,18 +8,19 @@
 (function() {
   var fs = require('fs');
   var path = require('path');
-
   var hogan = require('hogan.js');

   var hoganTemplates = require('./templates/diff2html-templates.js');

-  var templatesPath = path.resolve(__dirname, 'templates');
+  var extraTemplates;

-  function HoganJsUtils() {
+  function HoganJsUtils(configuration) {
+    this.config = configuration || {};
+    extraTemplates = this.config.templates || {};
   }

-  HoganJsUtils.prototype.render = function(namespace, view, params, configuration) {
-    var template = this.template(namespace, view, configuration);
+  HoganJsUtils.prototype.render = function(namespace, view, params) {
+    var template = this.template(namespace, view);
     if (template) {
       return template.render(params);
     }
@@ -27,17 +28,16 @@
     return null;
   };

-  HoganJsUtils.prototype.template = function(namespace, view, configuration) {
-    var config = configuration || {};
+  HoganJsUtils.prototype.template = function(namespace, view) {
     var templateKey = this._templateKey(namespace, view);

-    return this._getTemplate(templateKey, config);
+    return this._getTemplate(templateKey);
   };

-  HoganJsUtils.prototype._getTemplate = function(templateKey, config) {
+  HoganJsUtils.prototype._getTemplate = function(templateKey) {
     var template;

-    if (!config.noCache) {
+    if (!this.config.noCache) {
       template = this._readFromCache(templateKey);
     }

@@ -53,6 +53,7 @@

     try {
       if (fs.readFileSync) {
+        var templatesPath = path.resolve(__dirname, 'templates');
         var templatePath = path.join(templatesPath, templateKey);
         var templateContent = fs.readFileSync(templatePath + '.mustache', 'utf8');
         template = hogan.compile(templateContent);
@@ -66,12 +67,16 @@
   };

   HoganJsUtils.prototype._readFromCache = function(templateKey) {
-    return hoganTemplates[templateKey];
+    return extraTemplates[templateKey] || hoganTemplates[templateKey];
   };

   HoganJsUtils.prototype._templateKey = function(namespace, view) {
     return namespace + '-' + view;
   };

-  module.exports.HoganJsUtils = new HoganJsUtils();
+  HoganJsUtils.prototype.compile = function(templateStr) {
+    return hogan.compile(templateStr);
+  };
+
+  module.exports.HoganJsUtils = HoganJsUtils;
 })();
diff --git a/src/html-printer.js b/src/html-printer.js
index 585d5b66..13f83047 100644
--- a/src/html-printer.js
+++ b/src/html-printer.js
@@ -8,6 +8,7 @@
 (function() {
   var LineByLinePrinter = require('./line-by-line-printer.js').LineByLinePrinter;
   var SideBySidePrinter = require('./side-by-side-printer.js').SideBySidePrinter;
+  var FileListPrinter = require('./file-list-printer.js').FileListPrinter;

   function HtmlPrinter() {
   }
@@ -22,5 +23,10 @@
     return sideBySidePrinter.generateSideBySideJsonHtml(diffFiles);
   };

+  HtmlPrinter.prototype.generateFileListSummary = function(diffJson, config) {
+    var fileListPrinter = new FileListPrinter(config);
+    return fileListPrinter.generateFileList(diffJson);
+  };
+
   module.exports.HtmlPrinter = new HtmlPrinter();
 })();
diff --git a/src/line-by-line-printer.js b/src/line-by-line-printer.js
index b07eb53c..d230bedd 100644
--- a/src/line-by-line-printer.js
+++ b/src/line-by-line-printer.js
@@ -11,7 +11,8 @@
   var utils = require('./utils.js').Utils;
   var Rematch = require('./rematch.js').Rematch;

-  var hoganUtils = require('./hoganjs-utils.js').HoganJsUtils;
+  var hoganUtils;
+
   var genericTemplatesPath = 'generic';
   var baseTemplatesPath = 'line-by-line';
   var iconsBaseTemplatesPath = 'icon';
@@ -19,6 +20,9 @@

   function LineByLinePrinter(config) {
     this.config = config;
+
+    var HoganJsUtils = require('./hoganjs-utils.js').HoganJsUtils;
+    hoganUtils = new HoganJsUtils(config);
   }

   LineByLinePrinter.prototype.makeFileDiffHtml = function(file, diffs) {
diff --git a/src/side-by-side-printer.js b/src/side-by-side-printer.js
index bbf1dc8d..5e3033b3 100644
--- a/src/side-by-side-printer.js
+++ b/src/side-by-side-printer.js
@@ -11,7 +11,8 @@
   var utils = require('./utils.js').Utils;
   var Rematch = require('./rematch.js').Rematch;

-  var hoganUtils = require('./hoganjs-utils.js').HoganJsUtils;
+  var hoganUtils;
+
   var genericTemplatesPath = 'generic';
   var baseTemplatesPath = 'side-by-side';
   var iconsBaseTemplatesPath = 'icon';
@@ -26,6 +27,9 @@

   function SideBySidePrinter(config) {
     this.config = config;
+
+    var HoganJsUtils = require('./hoganjs-utils.js').HoganJsUtils;
+    hoganUtils = new HoganJsUtils(config);
   }

   SideBySidePrinter.prototype.makeDiffHtml = function(file, diffs) {
diff --git a/test/file-list-printer-tests.js b/test/file-list-printer-tests.js
index a502a46f..60ea3208 100644
--- a/test/file-list-printer-tests.js
+++ b/test/file-list-printer-tests.js
@@ -1,6 +1,6 @@
 var assert = require('assert');

-var fileListPrinter = require('../src/file-list-printer.js').FileListPrinter;
+var fileListPrinter = new (require('../src/file-list-printer.js').FileListPrinter)();

 describe('FileListPrinter', function() {
   describe('generateFileList', function() {
diff --git a/test/hogan-cache-tests.js b/test/hogan-cache-tests.js
index 190bf6f8..3bb754ac 100644
--- a/test/hogan-cache-tests.js
+++ b/test/hogan-cache-tests.js
@@ -1,6 +1,6 @@
 var assert = require('assert');

-var HoganJsUtils = require('../src/hoganjs-utils.js').HoganJsUtils;
+var HoganJsUtils = new (require('../src/hoganjs-utils.js').HoganJsUtils)();
 var diffParser = require('../src/diff-parser.js').DiffParser;

 describe('HoganJsUtils', function() {
@@ -21,16 +21,28 @@ describe('HoganJsUtils', function() {
       });
       assert.equal(emptyDiffHtml, result);
     });
+
     it('should render view without cache', function() {
       var result = HoganJsUtils.render('generic', 'empty-diff', {
         contentClass: 'd2h-code-line',
         diffParser: diffParser
       }, {noCache: true});
-      assert.equal(emptyDiffHtml + '\n', result);
+      assert.equal(emptyDiffHtml, result);
     });
+
     it('should return null if template is missing', function() {
-      var result = HoganJsUtils.render('generic', 'missing-template', {}, {noCache: true});
+      var hoganUtils = new (require('../src/hoganjs-utils.js').HoganJsUtils)({noCache: true});
+      var result = hoganUtils.render('generic', 'missing-template', {});
       assert.equal(null, result);
     });
+
+    it('should allow templates to be overridden', function() {
+      var emptyDiffTemplate = HoganJsUtils.compile('&lt;p&gt;&lt;/p&gt;');
+
+      var config = {templates: {'generic-empty-diff': emptyDiffTemplate}};
+      var hoganUtils = new (require('../src/hoganjs-utils.js').HoganJsUtils)(config);
+      var result = hoganUtils.render('generic', 'empty-diff', {myName: 'Rodrigo Fernandes'});
+      assert.equal('&lt;p&gt;Rodrigo Fernandes&lt;/p&gt;', result);
+    });
   });
 });
diff --git a/test/line-by-line-tests.js b/test/line-by-line-tests.js
index 1cd92073..8869b3df 100644
--- a/test/line-by-line-tests.js
+++ b/test/line-by-line-tests.js
@@ -14,7 +14,7 @@ describe('LineByLinePrinter', function() {
         '            File without changes\n' +
         '        &lt;/div&gt;\n' +
         '    &lt;/td&gt;\n' +
-        '&lt;/tr&gt;\n';
+        '&lt;/tr&gt;';

       assert.equal(expected, fileHtml);
     });
@@ -422,7 +422,6 @@ describe('LineByLinePrinter', function() {
         '        &lt;/div&gt;\n' +
         '    &lt;/td&gt;\n' +
         '&lt;/tr&gt;\n' +
-        '\n' +
         '                &lt;/tbody&gt;\n' +
         '            &lt;/table&gt;\n' +
         '        &lt;/div&gt;\n' +
diff --git a/test/side-by-side-printer-tests.js b/test/side-by-side-printer-tests.js
index 76625f8e..771daaa5 100644
--- a/test/side-by-side-printer-tests.js
+++ b/test/side-by-side-printer-tests.js
@@ -14,7 +14,7 @@ describe('SideBySidePrinter', function() {
         '            File without changes\n' +
         '        &lt;/div&gt;\n' +
         '    &lt;/td&gt;\n' +
-        '&lt;/tr&gt;\n';
+        '&lt;/tr&gt;';

       assert.equal(expectedRight, fileHtml.right);
       assert.equal(expectedLeft, fileHtml.left);
@@ -324,7 +324,6 @@ describe('SideBySidePrinter', function() {
         '        &lt;/div&gt;\n' +
         '    &lt;/td&gt;\n' +
         '&lt;/tr&gt;\n' +
-        '\n' +
         '                    &lt;/tbody&gt;\n' +
         '                &lt;/table&gt;\n' +
         '            &lt;/div&gt;\n' +

From f3cadb96677d0eb82fc2752dc3ffbf35ca9b5bdb Mon Sep 17 00:00:00 2001
From: Rodrigo Fernandes &lt;rtfrodrigo@gmail.com&gt;
Date: Sat, 15 Oct 2016 13:21:22 +0100
Subject: [PATCH 2/2] Allow uncompiled templates

---
 README.md                 |  3 +++
 src/hoganjs-utils.js      |  7 +++++++
 test/hogan-cache-tests.js | 24 +++++++++++++++++++++++-
 3 files changed, 33 insertions(+), 1 deletion(-)

diff --git a/README.md b/README.md
index 132c8a28..46909f25 100644
--- a/README.md
+++ b/README.md
@@ -98,6 +98,9 @@ The HTML output accepts a Javascript object with configuration. Possible options
   - `synchronisedScroll`: scroll both panes in side-by-side mode: `true` or `false`, default is `false`
   - `matchWordsThreshold`: similarity threshold for word matching, default is 0.25
   - `matchingMaxComparisons`: perform at most this much comparisons for line matching a block of changes, default is `2500`
+  - `templates`: object with previously compiled templates to replace parts of the html
+  - `rawTemplates`: object with raw not compiled templates to replace parts of the html
+  &gt; For more information regarding the possible templates look into [src/templates](https://github.com/rtfpessoa/diff2html/tree/master/src/templates)

 ## Diff2HtmlUI Helper

diff --git a/src/hoganjs-utils.js b/src/hoganjs-utils.js
index 0dda08d7..b2e9c275 100644
--- a/src/hoganjs-utils.js
+++ b/src/hoganjs-utils.js
@@ -17,6 +17,13 @@
   function HoganJsUtils(configuration) {
     this.config = configuration || {};
     extraTemplates = this.config.templates || {};
+
+    var rawTemplates = this.config.rawTemplates || {};
+    for (var templateName in rawTemplates) {
+      if (rawTemplates.hasOwnProperty(templateName)) {
+        if (!extraTemplates[templateName]) extraTemplates[templateName] = this.compile(rawTemplates[templateName]);
+      }
+    }
   }

   HoganJsUtils.prototype.render = function(namespace, view, params) {
diff --git a/test/hogan-cache-tests.js b/test/hogan-cache-tests.js
index 3bb754ac..a34839c0 100644
--- a/test/hogan-cache-tests.js
+++ b/test/hogan-cache-tests.js
@@ -36,7 +36,7 @@ describe('HoganJsUtils', function() {
       assert.equal(null, result);
     });

-    it('should allow templates to be overridden', function() {
+    it('should allow templates to be overridden with compiled templates', function() {
       var emptyDiffTemplate = HoganJsUtils.compile('&lt;p&gt;&lt;/p&gt;');

       var config = {templates: {'generic-empty-diff': emptyDiffTemplate}};
@@ -44,5 +44,27 @@ describe('HoganJsUtils', function() {
       var result = hoganUtils.render('generic', 'empty-diff', {myName: 'Rodrigo Fernandes'});
       assert.equal('&lt;p&gt;Rodrigo Fernandes&lt;/p&gt;', result);
     });
+
+    it('should allow templates to be overridden with uncompiled templates', function() {
+      var emptyDiffTemplate = '&lt;p&gt;&lt;/p&gt;';
+
+      var config = {rawTemplates: {'generic-empty-diff': emptyDiffTemplate}};
+      var hoganUtils = new (require('../src/hoganjs-utils.js').HoganJsUtils)(config);
+      var result = hoganUtils.render('generic', 'empty-diff', {myName: 'Rodrigo Fernandes'});
+      assert.equal('&lt;p&gt;Rodrigo Fernandes&lt;/p&gt;', result);
+    });
+
+    it('should allow templates to be overridden giving priority to compiled templates', function() {
+      var emptyDiffTemplate = HoganJsUtils.compile('&lt;p&gt;&lt;/p&gt;');
+      var emptyDiffTemplateUncompiled = '&lt;p&gt;Not used!&lt;/p&gt;';
+
+      var config = {
+        templates: {'generic-empty-diff': emptyDiffTemplate},
+        rawTemplates: {'generic-empty-diff': emptyDiffTemplateUncompiled}
+      };
+      var hoganUtils = new (require('../src/hoganjs-utils.js').HoganJsUtils)(config);
+      var result = hoganUtils.render('generic', 'empty-diff', {myName: 'Rodrigo Fernandes'});
+      assert.equal('&lt;p&gt;Rodrigo Fernandes&lt;/p&gt;', result);
+    });
   });
 });
</code></pre>]]></content><author><name></name></author><category term="sample-posts"/><category term="formatting"/><category term="code"/><summary type="html"><![CDATA[this is how you can display code diffs]]></summary></entry><entry><title type="html">a post with advanced image components</title><link href="https://zezedp.github.io/blog/2024/advanced-images/" rel="alternate" type="text/html" title="a post with advanced image components"/><published>2024-01-27T11:46:00+00:00</published><updated>2024-01-27T11:46:00+00:00</updated><id>https://zezedp.github.io/blog/2024/advanced-images</id><content type="html" xml:base="https://zezedp.github.io/blog/2024/advanced-images/"><![CDATA[<p>This is an example post with advanced image components.</p> <h2 id="image-slider">Image Slider</h2> <p>This is a simple image slider. It uses the <a href="https://swiperjs.com/">Swiper</a> library. Check the <a href="https://swiperjs.com/demos">examples page</a> for more information of what you can achieve with it.</p> <swiper-container keyboard="true" navigation="true" pagination="true" pagination-clickable="true" pagination-dynamic-bullets="true" rewind="true"> <swiper-slide> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/9-480.webp 480w,/assets/img/9-800.webp 800w,/assets/img/9-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/9.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </swiper-slide> <swiper-slide> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/7-480.webp 480w,/assets/img/7-800.webp 800w,/assets/img/7-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/7.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </swiper-slide> <swiper-slide> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/8-480.webp 480w,/assets/img/8-800.webp 800w,/assets/img/8-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/8.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </swiper-slide> <swiper-slide> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/10-480.webp 480w,/assets/img/10-800.webp 800w,/assets/img/10-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/10.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </swiper-slide> <swiper-slide> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/12-480.webp 480w,/assets/img/12-800.webp 800w,/assets/img/12-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/12.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </swiper-slide> </swiper-container> <h2 id="image-comparison-slider">Image Comparison Slider</h2> <p>This is a simple image comparison slider. It uses the <a href="https://img-comparison-slider.sneas.io/">img-comparison-slider</a> library. Check the <a href="https://img-comparison-slider.sneas.io/examples.html">examples page</a> for more information of what you can achieve with it.</p> <img-comparison-slider> <figure slot="first"> <picture> <source class="responsive-img-srcset" srcset="/assets/img/prof_pic-480.webp 480w,/assets/img/prof_pic-800.webp 800w,/assets/img/prof_pic-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/prof_pic.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> <figure slot="second"> <picture> <source class="responsive-img-srcset" srcset="/assets/img/prof_pic_color-480.webp 480w,/assets/img/prof_pic_color-800.webp 800w,/assets/img/prof_pic_color-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/prof_pic_color.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </img-comparison-slider>]]></content><author><name></name></author><category term="sample-posts"/><category term="formatting"/><category term="images"/><summary type="html"><![CDATA[this is what advanced image components could look like]]></summary></entry><entry><title type="html">a post with vega lite</title><link href="https://zezedp.github.io/blog/2024/vega-lite/" rel="alternate" type="text/html" title="a post with vega lite"/><published>2024-01-27T00:20:00+00:00</published><updated>2024-01-27T00:20:00+00:00</updated><id>https://zezedp.github.io/blog/2024/vega-lite</id><content type="html" xml:base="https://zezedp.github.io/blog/2024/vega-lite/"><![CDATA[<p>Teste de edição This is an example post with some <a href="https://vega.github.io/vega-lite/">vega lite</a> code.</p> <div class="language-markdown highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">```</span><span class="nl">vega_lite
</span><span class="sb">{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "description": "A dot plot showing each movie in the database, and the difference from the average movie rating. The display is sorted by year to visualize everything in sequential order. The graph is for all Movies before 2019.",
  "data": {
    "url": "https://raw.githubusercontent.com/vega/vega/main/docs/data/movies.json"
  },
  "transform": [
    {"filter": "datum['IMDB Rating'] != null"},
    {"filter": {"timeUnit": "year", "field": "Release Date", "range": [null, 2019]}},
    {
      "joinaggregate": [{
        "op": "mean",
        "field": "IMDB Rating",
        "as": "AverageRating"
      }]
    },
    {
      "calculate": "datum['IMDB Rating'] - datum.AverageRating",
      "as": "RatingDelta"
    }
  ],
  "mark": "point",
  "encoding": {
    "x": {
      "field": "Release Date",
      "type": "temporal"
    },
    "y": {
      "field": "RatingDelta",
      "type": "quantitative",
      "title": "Rating Delta"
    },
    "color": {
      "field": "RatingDelta",
      "type": "quantitative",
      "scale": {"domainMid": 0},
      "title": "Rating Delta"
    }
  }
}</span>
<span class="p">```</span>
</code></pre></div></div> <p>Which generates:</p> <pre><code class="language-vega_lite">{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "description": "A dot plot showing each movie in the database, and the difference from the average movie rating. The display is sorted by year to visualize everything in sequential order. The graph is for all Movies before 2019.",
  "data": {
    "url": "https://raw.githubusercontent.com/vega/vega/main/docs/data/movies.json"
  },
  "transform": [
    {"filter": "datum['IMDB Rating'] != null"},
    {"filter": {"timeUnit": "year", "field": "Release Date", "range": [null, 2019]}},
    {
      "joinaggregate": [{
        "op": "mean",
        "field": "IMDB Rating",
        "as": "AverageRating"
      }]
    },
    {
      "calculate": "datum['IMDB Rating'] - datum.AverageRating",
      "as": "RatingDelta"
    }
  ],
  "mark": "point",
  "encoding": {
    "x": {
      "field": "Release Date",
      "type": "temporal"
    },
    "y": {
      "field": "RatingDelta",
      "type": "quantitative",
      "title": "Rating Delta"
    },
    "color": {
      "field": "RatingDelta",
      "type": "quantitative",
      "scale": {"domainMid": 0},
      "title": "Rating Delta"
    }
  }
}
</code></pre> <p>This plot supports both light and dark themes.</p>]]></content><author><name></name></author><category term="sample-posts"/><category term="formatting"/><category term="charts"/><summary type="html"><![CDATA[this is what included vega lite code could look like]]></summary></entry><entry><title type="html">a post with geojson</title><link href="https://zezedp.github.io/blog/2024/geojson-map/" rel="alternate" type="text/html" title="a post with geojson"/><published>2024-01-26T17:57:00+00:00</published><updated>2024-01-26T17:57:00+00:00</updated><id>https://zezedp.github.io/blog/2024/geojson-map</id><content type="html" xml:base="https://zezedp.github.io/blog/2024/geojson-map/"><![CDATA[<p>This is an example post with some <a href="https://geojson.org/">geojson</a> code. The support is provided thanks to <a href="https://leafletjs.com/">Leaflet</a>. To create your own visualization, go to <a href="https://geojson.io/">geojson.io</a>.</p> <div class="language-markdown highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">```</span><span class="nl">geojson
</span><span class="sb">{
  "type": "FeatureCollection",
  "features": [
    {
      "type": "Feature",
      "properties": {},
      "geometry": {
        "coordinates": [
          [
            [
              -60.11363029935569,
              -2.904625022183211
            ],
            [
              -60.11363029935569,
              -3.162613728707967
            ],
            [
              -59.820894493858034,
              -3.162613728707967
            ],
            [
              -59.820894493858034,
              -2.904625022183211
            ],
            [
              -60.11363029935569,
              -2.904625022183211
            ]
          ]
        ],
        "type": "Polygon"
      }
    }
  ]
}</span>
<span class="p">```</span>
</code></pre></div></div> <p>Which generates:</p> <pre><code class="language-geojson">{
  "type": "FeatureCollection",
  "features": [
    {
      "type": "Feature",
      "properties": {},
      "geometry": {
        "coordinates": [
          [
            [
              -60.11363029935569,
              -2.904625022183211
            ],
            [
              -60.11363029935569,
              -3.162613728707967
            ],
            [
              -59.820894493858034,
              -3.162613728707967
            ],
            [
              -59.820894493858034,
              -2.904625022183211
            ],
            [
              -60.11363029935569,
              -2.904625022183211
            ]
          ]
        ],
        "type": "Polygon"
      }
    }
  ]
}
</code></pre>]]></content><author><name></name></author><category term="sample-posts"/><category term="formatting"/><category term="charts"/><category term="maps"/><summary type="html"><![CDATA[this is what included geojson code could look like]]></summary></entry><entry><title type="html">a post with echarts</title><link href="https://zezedp.github.io/blog/2024/echarts/" rel="alternate" type="text/html" title="a post with echarts"/><published>2024-01-26T16:03:00+00:00</published><updated>2024-01-26T16:03:00+00:00</updated><id>https://zezedp.github.io/blog/2024/echarts</id><content type="html" xml:base="https://zezedp.github.io/blog/2024/echarts/"><![CDATA[<p>This is an example post with some <a href="https://echarts.apache.org/">echarts</a> code.</p> <div class="language-markdown highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">```</span><span class="nl">echarts
</span><span class="sb">{
  "title": {
    "text": "ECharts Getting Started Example"
  },
  "responsive": true,
  "tooltip": {},
  "legend": {
    "top": "30px",
    "data": ["sales"]
  },
  "xAxis": {
    "data": ["Shirts", "Cardigans", "Chiffons", "Pants", "Heels", "Socks"]
  },
  "yAxis": {},
  "series": [
    {
      "name": "sales",
      "type": "bar",
      "data": [5, 20, 36, 10, 10, 20]
    }
  ]
}</span>
<span class="p">```</span>
</code></pre></div></div> <p>Which generates:</p> <pre><code class="language-echarts">{
  "title": {
    "text": "ECharts Getting Started Example"
  },
  "responsive": true,
  "tooltip": {},
  "legend": {
    "top": "30px",
    "data": ["sales"]
  },
  "xAxis": {
    "data": ["Shirts", "Cardigans", "Chiffons", "Pants", "Heels", "Socks"]
  },
  "yAxis": {},
  "series": [
    {
      "name": "sales",
      "type": "bar",
      "data": [5, 20, 36, 10, 10, 20]
    }
  ]
}
</code></pre> <p>Note that this library offer support for both light and dark themes. You can switch between them using the theme switcher in the top right corner of the page.</p>]]></content><author><name></name></author><category term="sample-posts"/><category term="formatting"/><category term="charts"/><summary type="html"><![CDATA[this is what included echarts code could look like]]></summary></entry><entry><title type="html">a post with chart.js</title><link href="https://zezedp.github.io/blog/2024/chartjs/" rel="alternate" type="text/html" title="a post with chart.js"/><published>2024-01-26T01:04:00+00:00</published><updated>2024-01-26T01:04:00+00:00</updated><id>https://zezedp.github.io/blog/2024/chartjs</id><content type="html" xml:base="https://zezedp.github.io/blog/2024/chartjs/"><![CDATA[<p>This is an example post with some <a href="https://www.chartjs.org/">chart.js</a> code.</p> <div class="language-markdown highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">```</span><span class="nl">chartjs
</span><span class="sb">{
  "type": "line",
  "data": {
    "labels": [
      "January",
      "February",
      "March",
      "April",
      "May",
      "June",
      "July"
    ],
    "datasets": [
      {
        "label": "# of bugs",
        "fill": false,
        "lineTension": 0.1,
        "backgroundColor": "rgba(75,192,192,0.4)",
        "borderColor": "rgba(75,192,192,1)",
        "borderCapStyle": "butt",
        "borderDash": [],
        "borderDashOffset": 0,
        "borderJoinStyle": "miter",
        "pointBorderColor": "rgba(75,192,192,1)",
        "pointBackgroundColor": "#fff",
        "pointBorderWidth": 1,
        "pointHoverRadius": 5,
        "pointHoverBackgroundColor": "rgba(75,192,192,1)",
        "pointHoverBorderColor": "rgba(220,220,220,1)",
        "pointHoverBorderWidth": 2,
        "pointRadius": 1,
        "pointHitRadius": 10,
        "data": [
          65,
          59,
          80,
          81,
          56,
          55,
          40
        ],
        "spanGaps": false
      }
    ]
  },
  "options": {}
}</span>
<span class="p">```</span>
</code></pre></div></div> <p>This is how it looks like:</p> <pre><code class="language-chartjs">{
  "type": "line",
  "data": {
    "labels": [
      "January",
      "February",
      "March",
      "April",
      "May",
      "June",
      "July"
    ],
    "datasets": [
      {
        "label": "# of bugs",
        "fill": false,
        "lineTension": 0.1,
        "backgroundColor": "rgba(75,192,192,0.4)",
        "borderColor": "rgba(75,192,192,1)",
        "borderCapStyle": "butt",
        "borderDash": [],
        "borderDashOffset": 0,
        "borderJoinStyle": "miter",
        "pointBorderColor": "rgba(75,192,192,1)",
        "pointBackgroundColor": "#fff",
        "pointBorderWidth": 1,
        "pointHoverRadius": 5,
        "pointHoverBackgroundColor": "rgba(75,192,192,1)",
        "pointHoverBorderColor": "rgba(220,220,220,1)",
        "pointHoverBorderWidth": 2,
        "pointRadius": 1,
        "pointHitRadius": 10,
        "data": [
          65,
          59,
          80,
          81,
          56,
          55,
          40
        ],
        "spanGaps": false
      }
    ]
  },
  "options": {}
}
</code></pre> <p>Also another example chart.</p> <div class="language-markdown highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">```</span><span class="nl">chartjs
</span><span class="sb">{
  "type": "doughnut",
  "data": {
    "labels": [
      "Red",
      "Blue",
      "Yellow"
    ],
    "datasets": [
      {
        "data": [
          300,
          50,
          100
        ],
        "backgroundColor": [
          "#FF6384",
          "#36A2EB",
          "#FFCE56"
        ],
        "hoverBackgroundColor": [
          "#FF6384",
          "#36A2EB",
          "#FFCE56"
        ]
      }
    ]
  },
  "options": {}
}</span>
<span class="p">```</span>
</code></pre></div></div> <p>Which generates:</p> <pre><code class="language-chartjs">{
  "type": "doughnut",
  "data": {
    "labels": [
      "Red",
      "Blue",
      "Yellow"
    ],
    "datasets": [
      {
        "data": [
          300,
          50,
          100
        ],
        "backgroundColor": [
          "#FF6384",
          "#36A2EB",
          "#FFCE56"
        ],
        "hoverBackgroundColor": [
          "#FF6384",
          "#36A2EB",
          "#FFCE56"
        ]
      }
    ]
  },
  "options": {}
}
</code></pre>]]></content><author><name></name></author><category term="sample-posts"/><category term="formatting"/><category term="charts"/><summary type="html"><![CDATA[this is what included chart.js code could look like]]></summary></entry><entry><title type="html">a post with TikZJax</title><link href="https://zezedp.github.io/blog/2023/tikzjax/" rel="alternate" type="text/html" title="a post with TikZJax"/><published>2023-12-12T22:25:00+00:00</published><updated>2023-12-12T22:25:00+00:00</updated><id>https://zezedp.github.io/blog/2023/tikzjax</id><content type="html" xml:base="https://zezedp.github.io/blog/2023/tikzjax/"><![CDATA[<p>This is an example post with TikZ code. TikZJax converts script tags (containing TikZ code) into SVGs.</p> <script type="text/tikz">
\begin{tikzpicture}
    \draw[red,fill=black!60!red] (0,0) circle [radius=1.5];
    \draw[green,fill=black!60!green] (0,0) circle [x radius=1.5cm, y radius=10mm];
    \draw[blue,fill=black!60!blue] (0,0) circle [x radius=1cm, y radius=5mm, rotate=30];
\end{tikzpicture}
</script>]]></content><author><name></name></author><category term="sample-posts"/><category term="formatting"/><category term="diagrams"/><summary type="html"><![CDATA[this is what included TikZ code could look like]]></summary></entry><entry><title type="html">a post with bibliography</title><link href="https://zezedp.github.io/blog/2023/post-bibliography/" rel="alternate" type="text/html" title="a post with bibliography"/><published>2023-07-12T13:56:00+00:00</published><updated>2023-07-12T13:56:00+00:00</updated><id>https://zezedp.github.io/blog/2023/post-bibliography</id><content type="html" xml:base="https://zezedp.github.io/blog/2023/post-bibliography/"><![CDATA[<p>This post shows how to add bibliography to simple blog posts. We support every citation style that <a href="https://github.com/inukshuk/jekyll-scholar">jekyll-scholar</a> does. That means simple citation like <a class="citation" href="#einstein1950meaning">(Einstein &amp; Taub, 1950)</a>, multiple citations like <a class="citation" href="#einstein1950meaning">(Einstein &amp; Taub, 1950; Einstein, 1905)</a>, long references like <span id="einstein1905movement">Einstein, A. (1905). Un the movement of small particles suspended in statiunary liquids required by the molecular-kinetic theory 0f heat. <i>Ann. Phys.</i>, <i>17</i>, 549–560.</span> or also quotes:</p> <blockquote><p>Lorem ipsum dolor sit amet, consectetur adipisicing elit,<br/>sed do eiusmod tempor.</p><p>Lorem ipsum dolor sit amet, consectetur adipisicing.</p><cite><a class="citation" href="#einstein1905electrodynamics">(Einstein, 1905)</a></cite></blockquote> <p>If you would like something more academic, check the <a href="/blog/2021/distill/">distill style post</a>.</p>]]></content><author><name></name></author><category term="sample-posts"/><category term="formatting"/><category term="bib"/><summary type="html"><![CDATA[an example of a blog post with bibliography]]></summary></entry><entry><title type="html">a post with jupyter notebook</title><link href="https://zezedp.github.io/blog/2023/jupyter-notebook/" rel="alternate" type="text/html" title="a post with jupyter notebook"/><published>2023-07-04T12:57:00+00:00</published><updated>2023-07-04T12:57:00+00:00</updated><id>https://zezedp.github.io/blog/2023/jupyter-notebook</id><content type="html" xml:base="https://zezedp.github.io/blog/2023/jupyter-notebook/"><![CDATA[<p>To include a jupyter notebook in a post, you can use the following code:</p> <div class="language-liquid highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{::nomarkdown}
<span class="cp">{%</span><span class="w"> </span><span class="nt">assign</span><span class="w"> </span><span class="nv">jupyter_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'assets/jupyter/blog.ipynb'</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="nf">relative_url</span><span class="w"> </span><span class="cp">%}</span>
<span class="cp">{%</span><span class="w"> </span><span class="nt">capture</span><span class="w"> </span><span class="nv">notebook_exists</span><span class="w"> </span><span class="cp">%}{%</span><span class="w"> </span><span class="nt">file_exists</span><span class="w"> </span>assets/jupyter/blog.ipynb<span class="w"> </span><span class="cp">%}{%</span><span class="w"> </span><span class="nt">endcapture</span><span class="w"> </span><span class="cp">%}</span>
<span class="cp">{%</span><span class="w"> </span><span class="nt">if</span><span class="w"> </span><span class="nv">notebook_exists</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">'true'</span><span class="w"> </span><span class="cp">%}</span>
  <span class="cp">{%</span><span class="w"> </span><span class="nt">jupyter_notebook</span><span class="w"> </span><span class="nv">jupyter_path</span><span class="w"> </span><span class="cp">%}</span>
<span class="cp">{%</span><span class="w"> </span><span class="nt">else</span><span class="w"> </span><span class="cp">%}</span>
  &lt;p&gt;Sorry, the notebook you are looking for does not exist.&lt;/p&gt;
<span class="cp">{%</span><span class="w"> </span><span class="nt">endif</span><span class="w"> </span><span class="cp">%}</span>
{:/nomarkdown}
</code></pre></div></div> <p>Let’s break it down: this is possible thanks to <a href="https://github.com/red-data-tools/jekyll-jupyter-notebook">Jekyll Jupyter Notebook plugin</a> that allows you to embed jupyter notebooks in your posts. It basically calls <a href="https://nbconvert.readthedocs.io/en/latest/usage.html#convert-html"><code class="language-plaintext highlighter-rouge">jupyter nbconvert --to html</code></a> to convert the notebook to an html page and then includes it in the post. Since <a href="https://jekyllrb.com/docs/configuration/markdown/">Kramdown</a> is the default Markdown renderer for Jekyll, we need to surround the call to the plugin with the <a href="https://kramdown.gettalong.org/syntax.html#extensions">::nomarkdown</a> tag so that it stops processing this part with Kramdown and outputs the content as-is.</p> <p>The plugin takes as input the path to the notebook, but it assumes the file exists. If you want to check if the file exists before calling the plugin, you can use the <code class="language-plaintext highlighter-rouge">file_exists</code> filter. This avoids getting a 404 error from the plugin and ending up displaying the main page inside of it instead. If the file does not exist, you can output a message to the user. The code displayed above outputs the following:</p> <div class="jupyter-notebook" style="position: relative; width: 100%; margin: 0 auto;"> <div class="jupyter-notebook-iframe-container"> <iframe src="/assets/jupyter/blog.ipynb.html" style="position: absolute; top: 0; left: 0; border-style: none;" width="100%" height="100%" onload="this.parentElement.style.paddingBottom = (this.contentWindow.document.documentElement.scrollHeight + 10) + 'px'"></iframe> </div> </div> <p>Note that the jupyter notebook supports both light and dark themes.</p>]]></content><author><name></name></author><category term="sample-posts"/><category term="formatting"/><category term="jupyter"/><summary type="html"><![CDATA[an example of a blog post with jupyter notebook]]></summary></entry></feed>